var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _superagent=_interopRequireDefault(require("superagent"));var _qs=_interopRequireDefault(require("qs"));var _Storage=_interopRequireDefault(require("./SDK/Storage"));var ApiClient=function(){function ApiClient(){var basePath=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'https://your_kinde_domain.kinde.com/api/v1';(0,_classCallCheck2["default"])(this,ApiClient);this.basePath=basePath.replace(/\/+$/,'');this.authentications={kindeBearerAuth:{type:'bearer'}};this.defaultHeaders={'User-Agent':'OpenAPI-Generator/1.1.0/Javascript'};this.timeout=60000;this.cache=true;this.enableCookies=false;if(typeof window==='undefined'){this.agent=new _superagent["default"].agent();}this.requestAgent=null;this.plugins=null;}(0,_createClass2["default"])(ApiClient,[{key:"paramToString",value:function paramToString(param){if(param==undefined||param==null){return'';}if(param instanceof Date){return param.toJSON();}if(ApiClient.canBeJsonified(param)){return JSON.stringify(param);}return param.toString();}},{key:"buildUrl",value:function buildUrl(path,pathParams,apiBasePath){var _this=this;if(!path.match(/^\//)){path='/'+path;}var url=this.basePath+path;if(apiBasePath!==null&&apiBasePath!==undefined){url=apiBasePath+path;}url=url.replace(/\{([\w-\.]+)\}/g,function(fullMatch,key){var value;if(pathParams.hasOwnProperty(key)){value=_this.paramToString(pathParams[key]);}else{value=fullMatch;}return encodeURIComponent(value);});return url;}},{key:"isJsonMime",value:function isJsonMime(contentType){return Boolean(contentType!=null&&contentType.match(/^application\/json(;.*)?$/i));}},{key:"jsonPreferredMime",value:function jsonPreferredMime(contentTypes){for(var i=0;i<contentTypes.length;i++){if(this.isJsonMime(contentTypes[i])){return contentTypes[i];}}return contentTypes[0];}},{key:"isFileParam",value:function isFileParam(param){if(typeof require==='function'){var fs;try{fs=require('fs');}catch(err){}if(fs&&fs.ReadStream&&param instanceof fs.ReadStream){return true;}}if(typeof Buffer==='function'&&param instanceof Buffer){return true;}if(typeof Blob==='function'&&param instanceof Blob){return true;}if(typeof File==='function'&&param instanceof File){return true;}return false;}},{key:"normalizeParams",value:function normalizeParams(params){var newParams={};for(var key in params){if(params.hasOwnProperty(key)&&params[key]!=undefined&&params[key]!=null){var value=params[key];if(this.isFileParam(value)||Array.isArray(value)){newParams[key]=value;}else{newParams[key]=this.paramToString(value);}}}return newParams;}},{key:"buildCollectionParam",value:function buildCollectionParam(param,collectionFormat){if(param==null){return null;}switch(collectionFormat){case'csv':return param.map(this.paramToString,this).join(',');case'ssv':return param.map(this.paramToString,this).join(' ');case'tsv':return param.map(this.paramToString,this).join('\t');case'pipes':return param.map(this.paramToString,this).join('|');case'multi':return param.map(this.paramToString,this);case'passthrough':return param;default:throw new Error('Unknown collection format: '+collectionFormat);}}},{key:"applyAuthToRequest",value:function applyAuthToRequest(request,authNames){var _this2=this;authNames.forEach(function(authName){var auth=_this2.authentications[authName];switch(auth.type){case'basic':if(auth.username||auth.password){request.auth(auth.username||'',auth.password||'');}break;case'bearer':if(auth.accessToken){var localVarBearerToken=typeof auth.accessToken==='function'?auth.accessToken():auth.accessToken;request.set({Authorization:'Bearer '+localVarBearerToken});}break;case'apiKey':if(auth.apiKey){var data={};if(auth.apiKeyPrefix){data[auth.name]=auth.apiKeyPrefix+' '+auth.apiKey;}else{data[auth.name]=auth.apiKey;}if(auth['in']==='header'){request.set(data);}else{request.query(data);}}break;case'oauth2':if(auth.accessToken){request.set({Authorization:'Bearer '+auth.accessToken});}break;default:throw new Error('Unknown authentication type: '+auth.type);}});}},{key:"deserialize",value:function deserialize(response,returnType){if(response==null||returnType==null||response.status==204){return null;}var data=response.body;if(data==null||(0,_typeof2["default"])(data)==='object'&&typeof data.length==='undefined'&&!Object.keys(data).length){data=response.text;}return ApiClient.convertToType(data,returnType);}},{key:"callApi",value:function(){var _callApi=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(path,httpMethod,pathParams,queryParams,headerParams,formParams,bodyParam,authNames,contentTypes,accepts,returnType,apiBasePath){var _this3=this;var url,request,index,accessToken,contentType,_formParams,key,_formParamsValue,accept;return _regenerator["default"].wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:url=this.buildUrl(path,pathParams,apiBasePath);request=(0,_superagent["default"])(httpMethod,url);if(this.plugins!==null){for(index in this.plugins){if(this.plugins.hasOwnProperty(index)){request.use(this.plugins[index]);}}}_context.next=5;return _Storage["default"].getAccessToken();case 5:accessToken=_context.sent;if(accessToken){request.set({Authorization:'Bearer '+accessToken});}this.applyAuthToRequest(request,authNames);if(httpMethod.toUpperCase()==='GET'&&this.cache===false){queryParams['_']=new Date().getTime();}request.query(this.normalizeParams(queryParams));request.set(this.defaultHeaders).set(this.normalizeParams(headerParams));if(this.requestAgent){request.agent(this.requestAgent);}request.timeout(this.timeout);contentType=this.jsonPreferredMime(contentTypes);if(contentType){if(contentType!='multipart/form-data'){request.type(contentType);}}if(contentType==='application/x-www-form-urlencoded'){request.send(_qs["default"].stringify(this.normalizeParams(formParams)));}else if(contentType=='multipart/form-data'){_formParams=this.normalizeParams(formParams);for(key in _formParams){if(_formParams.hasOwnProperty(key)){_formParamsValue=_formParams[key];if(this.isFileParam(_formParamsValue)){request.attach(key,_formParamsValue);}else if(Array.isArray(_formParamsValue)&&_formParamsValue.length&&this.isFileParam(_formParamsValue[0])){_formParamsValue.forEach(function(file){return request.attach(key,file);});}else{request.field(key,_formParamsValue);}}}}else if(bodyParam!==null&&bodyParam!==undefined){if(!request.header['Content-Type']){request.type('application/json');}request.send(bodyParam);}accept=this.jsonPreferredMime(accepts);if(accept){request.accept(accept);}if(returnType==='Blob'){request.responseType('blob');}else if(returnType==='String'){request.responseType('text');}else{request.responseType('json');}if(this.enableCookies){if(typeof window==='undefined'){this.agent._attachCookies(request);}else{request.withCredentials();}}return _context.abrupt("return",new Promise(function(resolve,reject){request.end(function(error,response){if(error){var err={};if(response){err.status=response.status;err.statusText=response.statusText;err.body=response.body;err.response=response;}err.error=error;reject(err);}else{try{var data=_this3.deserialize(response,returnType);if(_this3.enableCookies&&typeof window==='undefined'){_this3.agent._saveCookies(response);}resolve({data:data,response:response});}catch(err){reject(err);}}});}));case 21:case"end":return _context.stop();}},_callee,this);}));function callApi(_x,_x2,_x3,_x4,_x5,_x6,_x7,_x8,_x9,_x10,_x11,_x12){return _callApi.apply(this,arguments);}return callApi;}()},{key:"hostSettings",value:function hostSettings(){return[{url:'https://{businessName}.kinde.com/api/v1',description:'No description provided',variables:{businessName:{description:'Business Name created in the Kinde Console',default_value:'your_kinde_domain'}}}];}},{key:"getBasePathFromSettings",value:function getBasePathFromSettings(index){var variables=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var servers=this.hostSettings();if(index<0||index>=servers.length){throw new Error('Invalid index '+index+' when selecting the host settings. Must be less than '+servers.length);}var server=servers[index];var url=server['url'];for(var variable_name in server['variables']){if(variable_name in variables){var variable=server['variables'][variable_name];if(!('enum_values'in variable)||variable['enum_values'].includes(variables[variable_name])){url=url.replace('{'+variable_name+'}',variables[variable_name]);}else{throw new Error('The variable `'+variable_name+'` in the host URL has invalid value '+variables[variable_name]+'. Must be '+server['variables'][variable_name]['enum_values']+'.');}}else{url=url.replace('{'+variable_name+'}',server['variables'][variable_name]['default_value']);}}return url;}}],[{key:"canBeJsonified",value:function canBeJsonified(str){if(typeof str!=='string'&&(0,_typeof2["default"])(str)!=='object')return false;try{var type=str.toString();return type==='[object Object]'||type==='[object Array]';}catch(err){return false;}}},{key:"parseDate",value:function parseDate(str){if(isNaN(str)){return new Date(str.replace(/(\d)(T)(\d)/i,'$1 $3'));}return new Date(+str);}},{key:"convertToType",value:function convertToType(data,type){if(data===null||data===undefined)return data;switch(type){case'Boolean':return Boolean(data);case'Integer':return parseInt(data,10);case'Number':return parseFloat(data);case'String':return String(data);case'Date':return ApiClient.parseDate(String(data));case'Blob':return data;default:if(type===Object){return data;}else if(typeof type.constructFromObject==='function'){return type.constructFromObject(data);}else if(Array.isArray(type)){var itemType=type[0];return data.map(function(item){return ApiClient.convertToType(item,itemType);});}else if((0,_typeof2["default"])(type)==='object'){var keyType,valueType;for(var k in type){if(type.hasOwnProperty(k)){keyType=k;valueType=type[k];break;}}var result={};for(var k in data){if(data.hasOwnProperty(k)){var key=ApiClient.convertToType(k,keyType);var value=ApiClient.convertToType(data[k],valueType);result[key]=value;}}return result;}else{return data;}}}},{key:"constructFromObject",value:function constructFromObject(data,obj,itemType){if(Array.isArray(data)){for(var i=0;i<data.length;i++){if(data.hasOwnProperty(i))obj[i]=ApiClient.convertToType(data[i],itemType);}}else{for(var k in data){if(data.hasOwnProperty(k))obj[k]=ApiClient.convertToType(data[k],itemType);}}}}]);return ApiClient;}();ApiClient.CollectionFormatEnum={CSV:',',SSV:' ',TSV:'\t',PIPES:'|',MULTI:'multi'};ApiClient.instance=new ApiClient();var _default=ApiClient;exports["default"]=_default;