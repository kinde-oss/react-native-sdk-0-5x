var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _reactNative=require("react-native");var _urlParse=_interopRequireDefault(require("url-parse"));var _Utils=require("../Utils");var _Storage=_interopRequireDefault(require("../Storage"));var AuthorizationCode=function(){function AuthorizationCode(){(0,_classCallCheck2["default"])(this,AuthorizationCode);}(0,_createClass2["default"])(AuthorizationCode,[{key:"login",value:function(){var _login=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(kindSDK){var usePKCE,startPage,URLParsed,stateGenerated,challenge,_args=arguments;return _regenerator["default"].wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:usePKCE=_args.length>1&&_args[1]!==undefined?_args[1]:false;startPage=_args.length>2&&_args[2]!==undefined?_args[2]:'login';URLParsed=(0,_urlParse["default"])(kindSDK.authorizationEndpoint,true);URLParsed.query['client_id']=kindSDK.clientId;URLParsed.query['redirect_uri']=kindSDK.redirectUri;URLParsed.query['client_secret']=kindSDK.clientSecret;URLParsed.query['grant_type']='authorization_code';URLParsed.query['scope']=kindSDK.scope;URLParsed.query['start_page']=startPage;URLParsed.query['response_type']='code';stateGenerated=(0,_Utils.generateRandomString)();URLParsed.query['state']=stateGenerated;_Storage["default"].setState(stateGenerated);if(usePKCE){challenge=(0,_Utils.generateChallenge)();URLParsed.query['code_challenge']=challenge.codeChallenge;URLParsed.query['code_challenge_method']='S256';_Storage["default"].setCodeVerifier(challenge.codeVerifier);}_reactNative.Linking.openURL(URLParsed.toString());case 15:case"end":return _context.stop();}}},_callee);}));function login(_x){return _login.apply(this,arguments);}return login;}()}]);return AuthorizationCode;}();exports["default"]=AuthorizationCode;